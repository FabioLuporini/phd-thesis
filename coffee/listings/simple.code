


for (int i=0; i<I; ++i) {
  // Coefficient evaluation at point i
  for (int r=0; r<T; ++r) { 
    f0 += ...; f1 += ...; ...;
  }
  // Test functions
  for (int j=0; j<T; ++j)
    // Trial functions
    for (int k=0; k<T; ++k)
      M[j][k] += (((A[i][k]/c)*A[i][j])+
                  ((a*f0*A[i][j]+b*f1*B[i][j])*A[i][k]*g)+
	          (((d*D[i][k]+e*E[i][k])*A[i][j])*f)
                 )*det*W[i]
}
